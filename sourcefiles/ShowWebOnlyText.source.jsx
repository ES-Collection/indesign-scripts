// Set to 7.0 scripting object model (Indesign CS5)app.scriptPreferences.version = 7.0;(function() {    var myStory;    //Make certain that user interaction (display of dialogs, etc.) is turned on.    app.scriptPreferences.userInteractionLevel = UserInteractionLevels.interactWithAll;    if (app.documents.length == 0) {    	error_exit("No documents are open.  Please open a document and try again.");    }    if (app.selection.length == 0) {    	error_exit("Please select something and try again.");    }    if (app.selection.length > 1) {        error_exit("Please select only one item and try again.");    }        var mySel = app.selection[0];        switch (mySel.constructor.name) {    case "Character":    case "Word":    case "TextStyleRange":    case "Line":    case "Paragraph":    case "TextColumn":    case "Text":    case "Cell":    case "Column":    case "Row":    case "Table":    case "InsertionPoint":    case "TextFrame":            myStory = mySel.parentStory;        break;            case "Story":        myStory = mySel;        break;            default:        error_exit("Please select a story, part of a story or a text frame, and start again.");    }    if (!myStory.isValid) {    	error_exit( "There's been an error of indeterminate nature.  " +     	            "Probably best to blame the programmer." );    }    // AND NOW, THE MEAT OF THIS SCRIPT (THAT OTHER STUFF SHOULD BE IN A LIBRARY.)        if (!myStory.label) {        error_exit("There is currently no hidden web-only text associated with this story. " +                   "To add some, type in the words 'web only' on their own line at the end " +                   "of the story (if it's not already there), then type in your web-only text " +                   "after that (if it's not already there), then from the Edit menu, run the menu " +                   "item 'Hide Web-only Text'");    }        var mainStoryEnd = myStory.length;    myStory.insertionPoints[-1].contents = '\r\rWEB ONLY\r\r' + myStory.label;        // Apply a minimal style change so as to make it not look funny.    var myWebOnlyTrailer = myStory.characters.itemByRange(mainStoryEnd + 1, -1);    myWebOnlyTrailer.ruleAbove = false;    myWebOnlyTrailer.ruleBelow = false;    myWebOnlyTrailer.spaceBefore = '6pt';    myWebOnlyTrailer.spaceAfter = '0pt';    myStory.label = '';    function error_exit (message) {        if (arguments.length > 0) alert (unescape(message));        exit();    } })();