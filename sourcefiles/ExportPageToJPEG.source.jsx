#include utilities/util.jsxvar util = FORWARD.Util;var DEFAULT_PAGE_TO_EXPORT = "1";var EXPORT_RESOLUTION = 15.5; // This will shrink an 11.5 inch document to 178 pixels.var myDisplayDialog = function( defaultPageNumber ) {    var defaultText = defaultText || "";        var myDialog = app.dialogs.add({        name: "Which page do you want to save as a jpeg file?"    });        var myOuterColumns = [];    var myInnerColumns = [];    var myOuterRows = [];    var myBorderPanels = [];    var myTextEditboxes = [];    var myInput;        myOuterColumns[0] = myDialog.dialogColumns.add();    myOuterRows[0] = myOuterColumns[0].dialogRows.add();    myBorderPanels[0] = myOuterRows[0].borderPanels.add();    myInnerColumns[0] = myBorderPanels[0].dialogColumns.add();    myInnerColumns[0].staticTexts.add({        staticLabel: "Page:"    });        myInnerColumns[1] = myBorderPanels[0].dialogColumns.add();            myTextEditboxes[0] = myInnerColumns[1].textEditboxes.add({          minWidth: 200,          editContents: defaultPageNumber    });        var myResult = myDialog.show();    var myInput = myTextEditboxes[0].editContents;        //        myDialog.destroy() cannot be used because of a bug in ID CS5    //        on 64-bit machines. They totally crash. So we'll just    //        have the dialog boxes cluttering up non-Javascript-related    //        InDesign memory, but it's really unlikely to be all that bad.        //        myDialog.destroy();        if (myResult == false) {        exit();    }        return myInput;};if (app.documents.length === 0) util.errorExit('Please open a document and try again.');var doc = app.activeDocument;var pageToExport = myDisplayDialog( DEFAULT_PAGE_TO_EXPORT );// Clean up input.if (!pageToExport) exit();pageToExport.replace(/^\s*(.*?)/g, '$1');if (!doc.pages.itemByName( pageToExport ).isValid) {    util.errorExit( "Page " + pageToExport + " doesn't exist in this document. Try again." );}var file = File.saveDialog ("Please tell me where to save your brand new jpeg file.");if (file) {    // add '.jpg' if it (or a variation on it) is not already there    if (!file.name.match( /\.jpe?g$/i )) {        var newFilePath = file.fullName + '.jpg';        file.close();        file = File( newFilePath );    }    app.jpegExportPreferences.properties = {        exportingSpread: false,        jpegQuality: JPEGOptionsQuality.HIGH,        jpegExportRange: ExportRangeOrAllPages.EXPORT_RANGE,        pageString: pageToExport,        embedColorProfile: false,        jpegColorSpace: JpegColorSpaceEnum.RGB,        antiAlias: true,        exportResolution: EXPORT_RESOLUTION    };    app.activeDocument.exportFile(ExportFormat.JPG, file);}