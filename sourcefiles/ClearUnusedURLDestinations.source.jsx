var forEach = function( array, action ) {    if (array.everyItem)  // It's an InDesign DOM collection        array = array.everyItem().getElements();            var result = [];    for (var i = 0, len = array.length; i < len; i++ ) {        result.push( action( array[i], i ));    }    return result;};var isIn = function( searchValue, array ) {    var found = false;    forEach( array, function( candidate ) {        if (candidate === searchValue)             found = true;    });    return found;}Hyperlink.prototype.removeDeep = function() {    var src = this.source;    var dest = this.destination;    var destHidden = dest.hidden;        this.remove();    src.remove();    if (!destHidden)         dest.remove();}var doc = app.activeDocument;var destinationsToSave = forEach( doc.hyperlinks, function( link ) {    return link.destination;});forEach( doc.hyperlinkURLDestinations, function( dest ) {    if (!isIn( dest, destinationsToSave )) {        dest.remove();    }});alert("Unused URL Destinations cleared");    